{% extends 'layout.html' %}

{% block content %}
  <div class="bg-white rounded-lg shadow-lg overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-200">
      <h2 class="text-2xl font-bold text-gray-900">🏆 경매 결과 목록</h2>
      <p class="mt-1 text-sm text-gray-600">완료된 경매와 낙찰 결과를 확인하세요</p>
    </div>
    
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">상품명</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">사진</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">시작가</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">최고 입찰가</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">상태</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">등록일</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          {% for good in goods %}
            <tr class="hover:bg-gray-50 transition duration-150">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm font-medium text-gray-900">{{good.name}}</div>
                <div class="text-xs text-gray-500">등록자: {{good.Owner.nick}}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex-shrink-0 h-20 w-20">
                  <img class="h-20 w-20 rounded-lg object-cover border border-gray-200" 
                       src="/img/{{good.img}}" 
                       onerror="this.src='/default-image.svg'; this.onerror=null;" 
                       alt="{{good.name}}">
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">{{good.price}}원</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                {% if good.highestBid %}
                  <div class="text-sm font-bold text-blue-600">{{good.highestBid.bid}}원</div>
                  <div class="text-xs text-gray-500">입찰자: {{good.highestBid.User.nick}}</div>
                {% else %}
                  <div class="text-sm text-gray-400">입찰 없음</div>
                {% endif %}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                {% if good.status == 'sold' %}
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                    <svg class="w-2 h-2 mr-1.5" fill="currentColor" viewBox="0 0 8 8">
                      <circle cx="4" cy="4" r="3"></circle>
                    </svg>
                    낙찰 완료
                  </span>
                  <div class="text-xs text-gray-500 mt-1">낙찰자: {{good.Winner.nick}}</div>
                {% elif good.status == 'ended_no_winner' %}
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                    <svg class="w-2 h-2 mr-1.5" fill="currentColor" viewBox="0 0 8 8">
                      <circle cx="4" cy="4" r="3"></circle>
                    </svg>
                    낙찰 대기
                  </span>
                {% else %}
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                    <svg class="w-2 h-2 mr-1.5" fill="currentColor" viewBox="0 0 8 8">
                      <circle cx="4" cy="4" r="3"></circle>
                    </svg>
                    입찰 없음
                  </span>
                {% endif %}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">{{good.createdAt.toLocaleDateString('ko-KR')}}</div>
                <div class="text-xs text-gray-500">{{good.createdAt.toLocaleTimeString('ko-KR')}}</div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    {% if goods|length == 0 %}
      <div class="text-center py-12">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h3 class="mt-2 text-sm font-medium text-gray-900">종료된 경매가 없습니다</h3>
        <p class="mt-1 text-sm text-gray-500">경매에 참여해보세요!</p>
      </div>
    {% endif %}
  </div>
{% endblock %}
